document.addEventListener("DOMContentLoaded",()=>{function e(e){for(;e&&!e.matches("h1, h2, h3, h4");)e=e.previousElementSibling;return e?.id}function t(e){for(s of(r=(r||e).map(t=>e.find(e=>e.target===t.target)||t),r))s.isIntersecting||l[s.target.previousHeader]?.parentElement.classList.remove("selected","parent");for(s of r)if(s.isIntersecting){let e=l[s.target.previousHeader]?.closest("li");if(e?.classList.add("selected"),void 0===e)continue;let t=e.firstChild;for(console.log(e,t),t.scrollIntoView({block:"nearest",inline:"nearest"});e;)e?.classList.add("parent"),e=e.parentElement.closest("li")}}let r,n=new IntersectionObserver(t,{threshold:[0]}),o=[...document.querySelectorAll("section > *")],i=[...document.querySelectorAll(".toc a")],l=o.reduce((t,r)=>{let s=e(r);if(r.previousHeader=s,s){let e=i.find(e=>decodeURIComponent(e.hash)==="#"+s);t[s]=e}return t},{});o.forEach(e=>n.observe(e))});